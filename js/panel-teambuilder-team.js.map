{"version":3,"sources":["../src/panel-teambuilder-team.tsx"],"names":["TeamRoom","team","PSRoom","TeamTextbox","setInfo","sets","textbox","heightTester","activeType","activeOffsetY","activeSetIndex","search","DexSearch","input","update","select","closeMenu","forceUpdate","focus","cursorOnly","style","width","offsetWidth","value","index","setIndex","selectionStart","selectionEnd","parseState","length","nlIndex","indexOf","line","slice","trim","bottomY","getYAt","atIndex","species","endsWith","parenIndex","lastIndexOf","push","selectionEndCutoff","lcLine","toLowerCase","startsWith","setType","find","window","height","save","scrollHeight","PSTeambuilder","importTeam","props","packedTeam","packTeam","iconCache","PS","teams","componentDidMount","base","getElementsByClassName","unpackTeam","exportedTeam","exportTeam","componentWillUnmount","render","map","info","i","prevOffset","num","Dex","getPokemonIconNum","toID","top","Math","floor","left","iconStyle","resourcePrefix","preact","Component","TeamPanel","backToList","removeRoom","room","join","rename","e","currentTarget","name","byKey","id","PSRoomPanel","roomTypes","Model","title","updateRoomTypes"],"mappings":"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","sourcesContent":["/**\r\n * Teambuilder team panel\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license AGPLv3\r\n */\r\n\r\nclass TeamRoom extends PSRoom {\r\n\tteam: Team | null = null;\r\n}\r\n\r\nclass TeamTextbox extends preact.Component<{team: Team}> {\r\n\tsetInfo: {\r\n\t\tspecies: string,\r\n\t\tbottomY: number,\r\n\t}[] = [];\r\n\tsets: PokemonSet[] = [];\r\n\ttextbox: HTMLTextAreaElement = null!;\r\n\theightTester: HTMLTextAreaElement = null!;\r\n\tactiveType: 'pokemon' | 'move' | 'item' | 'ability' | '' = '';\r\n\tactiveOffsetY = -1;\r\n\tactiveSetIndex = -1;\r\n\tsearch = new DexSearch();\r\n\tgetYAt(index: number, value: string) {\r\n\t\tif (index < 0) return 10;\r\n\t\tthis.heightTester.value = value.slice(0, index);\r\n\t\treturn this.heightTester.scrollHeight;\r\n\t}\r\n\tinput = () => this.update();\r\n\tselect = () => this.update(true);\r\n\tcloseMenu = () => {\r\n\t\tthis.activeType = '';\r\n\t\tthis.forceUpdate();\r\n\t\tthis.textbox.focus();\r\n\t};\r\n\tupdate = (cursorOnly?: boolean) => {\r\n\t\tconst textbox = this.textbox;\r\n\t\tthis.heightTester.style.width = `${textbox.offsetWidth}px`;\r\n\t\tconst value = textbox.value;\r\n\r\n\t\tlet index = 0;\r\n\t\tlet setIndex = -1;\r\n\t\tif (!cursorOnly) this.setInfo = [];\r\n\t\tthis.activeOffsetY = -1;\r\n\t\tthis.activeSetIndex = -1;\r\n\t\tthis.activeType = '';\r\n\r\n\t\tconst selectionStart = textbox.selectionStart || 0;\r\n\t\tconst selectionEnd = textbox.selectionEnd || 0;\r\n\r\n\t\t/** 0 = set top, 1 = set middle */\r\n\t\tlet parseState: 0 | 1 = 0;\r\n\t\twhile (index < value.length) {\r\n\t\t\tlet nlIndex = value.indexOf('\\n', index);\r\n\t\t\tif (nlIndex < 0) nlIndex = value.length;\r\n\t\t\tconst line = value.slice(index, nlIndex).trim();\r\n\r\n\t\t\tif (!line) {\r\n\t\t\t\tparseState = 0;\r\n\t\t\t\tindex = nlIndex + 1;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (parseState === 0 && index && !cursorOnly) {\r\n\t\t\t\tthis.setInfo[this.setInfo.length - 1].bottomY = this.getYAt(index - 1, value);\r\n\t\t\t}\r\n\r\n\t\t\tif (parseState === 0) {\r\n\t\t\t\tif (!cursorOnly) {\r\n\t\t\t\t\tconst atIndex = line.indexOf('@');\r\n\t\t\t\t\tlet species = atIndex >= 0 ? line.slice(0, atIndex).trim() : line;\r\n\t\t\t\t\tif (species.endsWith(' (M)') || species.endsWith(' (F)')) {\r\n\t\t\t\t\t\tspecies = species.slice(0, -4);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (species.endsWith(')')) {\r\n\t\t\t\t\t\tconst parenIndex = species.lastIndexOf(' (');\r\n\t\t\t\t\t\tif (parenIndex >= 0) {\r\n\t\t\t\t\t\t\tspecies = species.slice(parenIndex + 2, -1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setInfo.push({\r\n\t\t\t\t\t\tspecies,\r\n\t\t\t\t\t\tbottomY: -1,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tparseState = 1;\r\n\t\t\t\tsetIndex++;\r\n\t\t\t}\r\n\r\n\t\t\tconst selectionEndCutoff = (selectionStart === selectionEnd ? nlIndex : nlIndex + 1);\r\n\t\t\tif (index <= selectionStart && selectionEnd <= selectionEndCutoff) {\r\n\t\t\t\t// both ends within range\r\n\t\t\t\tthis.activeOffsetY = this.getYAt(index - 1, value);\r\n\t\t\t\tthis.activeSetIndex = setIndex;\r\n\r\n\t\t\t\tconst lcLine = line.toLowerCase().trim();\r\n\t\t\t\tif (lcLine.startsWith('ability:')) {\r\n\t\t\t\t\tthis.activeType = 'ability';\r\n\t\t\t\t} else if (lcLine.startsWith('-')) {\r\n\t\t\t\t\tthis.activeType = 'move';\r\n\t\t\t\t} else if (\r\n\t\t\t\t\t!lcLine || lcLine.startsWith('ivs:') || lcLine.startsWith('evs:') ||\r\n\t\t\t\t\tlcLine.startsWith('level:') || lcLine.startsWith('gender:') ||\r\n\t\t\t\t\tlcLine.endsWith(' nature') || lcLine.startsWith('shiny:')\r\n\t\t\t\t) {\r\n\t\t\t\t\t// leave activeType blank\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.activeType = 'pokemon';\r\n\t\t\t\t\tconst atIndex = line.indexOf('@');\r\n\t\t\t\t\tif (atIndex >= 0 && selectionStart > index + atIndex) {\r\n\t\t\t\t\t\tthis.activeType = 'item';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.search.setType(this.activeType, 'gen8ou' as ID, this.sets[setIndex]);\r\n\t\t\t\tthis.search.find('');\r\n\t\t\t\twindow.search = this.search;\r\n\t\t\t}\r\n\r\n\t\t\tindex = nlIndex + 1;\r\n\t\t}\r\n\t\tif (!cursorOnly) {\r\n\t\t\tconst bottomY = this.getYAt(value.length, value);\r\n\t\t\tif (this.setInfo.length) {\r\n\t\t\t\tthis.setInfo[this.setInfo.length - 1].bottomY = bottomY;\r\n\t\t\t}\r\n\r\n\t\t\ttextbox.style.height = `${bottomY + 100}px`;\r\n\t\t\tthis.save();\r\n\t\t}\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\tsave() {\r\n\t\tconst sets = PSTeambuilder.importTeam(this.textbox.value);\r\n\t\tthis.props.team.packedTeam = PSTeambuilder.packTeam(sets);\r\n\t\tthis.props.team.iconCache = null;\r\n\t\tPS.teams.save();\r\n\t}\r\n\tcomponentDidMount() {\r\n\t\tthis.textbox = this.base!.getElementsByClassName('teamtextbox')[0] as HTMLTextAreaElement;\r\n\t\tthis.heightTester = this.base!.getElementsByClassName('heighttester')[0] as HTMLTextAreaElement;\r\n\r\n\t\tthis.sets = PSTeambuilder.unpackTeam(this.props.team.packedTeam);\r\n\t\tconst exportedTeam = PSTeambuilder.exportTeam(this.sets);\r\n\t\tthis.textbox.value = exportedTeam;\r\n\t\tthis.update();\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tthis.textbox = null!;\r\n\t\tthis.heightTester = null!;\r\n\t}\r\n\trender() {\r\n\t\treturn <div class=\"teameditor\">\r\n\t\t\t<textarea class=\"textbox teamtextbox\" onInput={this.input} onSelect={this.select} onClick={this.select} onKeyUp={this.select} />\r\n\t\t\t<textarea\r\n\t\t\t\tclass=\"textbox teamtextbox heighttester\" style=\"visibility:hidden\" tabIndex={-1} aria-hidden={true}\r\n\t\t\t/>\r\n\t\t\t<div class=\"teamoverlays\">\r\n\t\t\t\t{this.setInfo.slice(0, -1).map(info =>\r\n\t\t\t\t\t<hr style={`top:${info.bottomY - 18}px`} />\r\n\t\t\t\t)}\r\n\t\t\t\t{this.setInfo.map((info, i) => {\r\n\t\t\t\t\tif (!info.species) return null;\r\n\t\t\t\t\tconst prevOffset = i === 0 ? 8 : this.setInfo[i - 1].bottomY;\r\n\t\t\t\t\tconst species = info.species;\r\n\t\t\t\t\tconst num = Dex.getPokemonIconNum(toID(species));\r\n\t\t\t\t\tif (!num) return null;\r\n\r\n\t\t\t\t\tconst top = Math.floor(num / 12) * 30;\r\n\t\t\t\t\tconst left = (num % 12) * 40;\r\n\t\t\t\t\tconst iconStyle = `background:transparent url(${Dex.resourcePrefix}sprites/pokemonicons-sheet.png) no-repeat scroll -${left}px -${top}px`;\r\n\r\n\t\t\t\t\treturn <span class=\"picon\" style={\r\n\t\t\t\t\t\t`top:${prevOffset + 1}px;left:50px;position:absolute;${iconStyle}`\r\n\t\t\t\t\t}></span>;\r\n\t\t\t\t})}\r\n\t\t\t\t{this.activeOffsetY >= 0 &&\r\n\t\t\t\t\t<div class=\"teaminnertextbox\" style={{top: this.activeOffsetY - 1}}></div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t\t{this.activeType && <div class=\"searchresults\" style={{top: this.activeSetIndex >= 0 ? this.setInfo[this.activeSetIndex].bottomY - 12 : 0}}>\r\n\t\t\t\t<button class=\"button closesearch\" onClick={this.closeMenu}><i class=\"fa fa-times\"></i> Close</button>\r\n\t\t\t\t<PSSearchResults search={this.search} />\r\n\t\t\t</div>}\r\n\t\t</div>;\r\n\t}\r\n}\r\n\r\nclass TeamPanel extends PSRoomPanel<TeamRoom> {\r\n\tbackToList = () => {\r\n\t\tPS.removeRoom(this.props.room);\r\n\t\tPS.join('teambuilder' as RoomID);\r\n\t};\r\n\trename = (e: Event) => {\r\n\t\tconst textbox = e.currentTarget as HTMLInputElement;\r\n\t\tconst room = this.props.room;\r\n\r\n\t\troom.team!.name = textbox.value.trim();\r\n\t\tPS.teams.save();\r\n\t};\r\n\trender() {\r\n\t\tconst room = this.props.room;\r\n\t\tconst team = PS.teams.byKey[room.id.slice(5)];\r\n\t\tif (!team) {\r\n\t\t\treturn <PSPanelWrapper room={room}>\r\n\t\t\t\t<button class=\"button\" onClick={this.backToList}>\r\n\t\t\t\t\t<i class=\"fa fa-chevron-left\"></i> List\r\n\t\t\t\t</button>\r\n\t\t\t\t<p class=\"error\">\r\n\t\t\t\t\tTeam doesn't exist\r\n\t\t\t\t</p>\r\n\t\t\t</PSPanelWrapper>;\r\n\t\t}\r\n\r\n\t\tif (!room.team) room.team = team;\r\n\t\treturn <PSPanelWrapper room={room} scrollable>\r\n\t\t\t<div class=\"pad\">\r\n\t\t\t\t<button class=\"button\" onClick={this.backToList}>\r\n\t\t\t\t\t<i class=\"fa fa-chevron-left\"></i> List\r\n\t\t\t\t</button>\r\n\t\t\t\t<label class=\"label teamname\">\r\n\t\t\t\t\tTeam name:\r\n\t\t\t\t\t<input class=\"textbox\" type=\"text\" value={team.name} onInput={this.rename} onChange={this.rename} onKeyUp={this.rename} />\r\n\t\t\t\t</label>\r\n\t\t\t\t<TeamTextbox team={team} />\r\n\t\t\t</div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nPS.roomTypes['team'] = {\r\n\tModel: TeamRoom,\r\n\tComponent: TeamPanel,\r\n\ttitle: \"Team\",\r\n};\r\nPS.updateRoomTypes();\r\n"],"file":"panel-teambuilder-team.js"}